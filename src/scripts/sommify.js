!function(e,i){"object"==typeof exports&&"undefined"!=typeof module?i(exports):"function"==typeof define&&define.amd?define(["exports"],i):i((e="undefined"!=typeof globalThis?globalThis:e||self).Sommify={})}(this,(function(e){"use strict";const i="https://elements.sommify.ai";const t=e=>{e.origin===i&&console.log(e.data)};var o="WIDGET_MOUNTED",s="WIDGET_OPENED",n="WIDGET_CLOSED",a="WIDGET_UNMOUNTED",c="EXIT",r="EXIT",d="ADD_TO_CART",l="BLUR",m="UPDATE_PARAMS",p="WINES_UPDATED",y="BEARER_TOKEN",f={en:{title:"Hi! 👋 Need help choosing the right wine?",subtitle:"Let our AI sommelier help you!",response:"Yes, please! 🍷",mobile:"Tap for our AI sommelier's help!"},it:{title:"Ciao! 👋 Hai bisogno di aiuto per scegliere il vino giusto?",subtitle:"Lascia che il nostro sommelier AI ti aiuti!",response:"Sì, per favore! 🍷",mobile:"Tocca per l'aiuto del nostro sommelier AI!"},fr:{title:"Salut! 👋 Besoin d'aide pour choisir le bon vin?",subtitle:"Laissez notre sommelier AI vous aider!",response:"Oui s'il vous plaît! 🍷",mobile:"Appuyez pour l'aide de notre sommelier AI!"},es:{title:"¡Hola! 👋 ¿Necesitas ayuda para elegir el vino adecuado?",subtitle:"¡Deja que nuestro sumiller AI te ayude!",response:"¡Sí por favor! 🍷",mobile:"¡Toque para la ayuda de nuestro sumiller AI!"},de:{title:"Hallo! 👋 Brauchen Sie Hilfe bei der Auswahl des richtigen Weins?",subtitle:"Lassen Sie sich von unserem AI Sommelier helfen!",response:"Ja, bitte! 🍷",mobile:"Tippen Sie für die Hilfe unseres AI Sommeliers!"},"pt-pt":{title:"Oi! 👋 Precisa de ajuda para escolher o vinho certo?",subtitle:"Deixe que o nosso sommelier AI o ajude!",response:"Sim por favor! 🍷",mobile:"Toque para a ajuda do nosso sommelier AI!"},ja:{title:"こんにちは！ 👋 適切なワインを選ぶのに役立ちますか？",subtitle:"AIソムリエにお任せください！",response:"はい、お願いします！ 🍷",mobile:"AIソムリエの助けを求めるにはタップしてください！"},zh:{title:"你好！ 👋 需要帮助选择合适的葡萄酒吗？",subtitle:"让我们的AI侍酒师帮助您！",response:"是的，请！ 🍷",mobile:"点击寻求我们的AI侍酒师的帮助！"},ko:{title:"안녕! 👋 적절한 와인을 선택하는 데 도움이 필요하십니까?",subtitle:"AI 소믈리에가 도와 드리겠습니다!",response:"네, 부탁해! 🍷",mobile:"AI 소믈리에의 도움을 받으려면 탭하세요!"},ru:{title:"Привет! 👋 Нужна помощь в выборе правильного вина?",subtitle:"Позвольте нашему AI сомелье вам помочь!",response:"Да, пожалуйста! 🍷",mobile:"Нажмите, чтобы получить помощь нашего AI сомелье!"},nl:{title:"Hallo! 👋 Heeft u hulp nodig bij het kiezen van de juiste wijn?",subtitle:"Laat onze AI-sommelier u helpen!",response:"Ja, alsjeblieft! 🍷",mobile:"Tik voor de hulp van onze AI-sommelier!"},et:{title:"Tere! 👋 Vajate abi õige veini valimisel?",subtitle:"Laske meie AI sommelieril teid aidata!",response:"Jah, palun! 🍷",mobile:"Puudutage meie AI sommelieri abi!"},fi:{title:"Hei! 👋 Tarvitsetko apua oikean viinin valitsemiseen?",subtitle:"Anna AI sommelierimme auttaa sinua!",response:"Kyllä kiitos! 🍷",mobile:"Napauta AI sommelierimme apua!"},sk:{title:"Ahoj! 👋 Potrebujete pomôcť pri výbere správneho vína?",subtitle:"Nechajte nášho AI sommeliéra, aby vám pomohol!",response:"Áno, prosím! 🍷",mobile:"Ťuknite pre pomoc od našeho AI sommeliéra!"},cs:{title:"Ahoj! 👋 Potřebujete pomoc při výběru správného vína?",subtitle:"Nechte našeho AI sommeliéra, aby vám pomohl!",response:"Ano prosím! 🍷",mobile:"Klepněte pro pomoc našeho AI sommeliéra!"}};const h=(e,i,t)=>fetch("https://api.sommify.ai/stats/user/track",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify({event:i,payload:t})});let u=!1,g=null;const w=()=>{const e=.01*window.innerHeight,i=.01*window.innerWidth;document.documentElement.style.setProperty("--sommify-vh",`${e}px`),document.documentElement.style.setProperty("--sommify-vw",`${i}px`)},b={Android:function(){return navigator.userAgent.match(/Android/i)},BlackBerry:function(){return navigator.userAgent.match(/BlackBerry/i)},iOS:function(){return navigator.userAgent.match(/iPhone|iPad|iPod/i)},Opera:function(){return navigator.userAgent.match(/Opera Mini/i)},Windows:function(){return navigator.userAgent.match(/IEMobile/i)||navigator.userAgent.match(/WPDesktop/i)},any:function(){return b.Android()||b.BlackBerry()||b.iOS()||b.Opera()||b.Windows()||window.innerWidth<550}};e.createEmbedded=function(e="interactive"){return{mount:(e,{width:o="420px",height:s="420px",...n})=>{var a=document.getElementById(e);if(a){const e=document.createElement("iframe"),c=function(e){const i=new URLSearchParams;for(const t in e)i.append(t,JSON.stringify(e[t]));return i.toString()}(n);e.src=i+"/interactive?"+c,e.height=s,e.width=o,e.style.border="none",a.appendChild(e),window.addEventListener("message",t)}else console.error(`Element with ID '${e}' not found.`)},unmount:e=>{var i=document.getElementById(e);i&&(i.innerHTML=""),window.removeEventListener("message",t)}}},e.createWidget=function({apiKey:e,localization:i="en",currency:t="EUR",position:v="bottom-right",triggerRadius:k=70,triggerPosition:_=v,triggerOffsetX:x=0,triggerOffsetY:E=0,triggerIcon:A="data:image/svg+xml,%3c%3fxml version='1.0' encoding='UTF-8' standalone='no'%3f%3e%3c!-- Created with Inkscape (http://www.inkscape.org/) --%3e%3csvg width='67.690643mm' height='81.385841mm' viewBox='0 0 67.690643 81.385841' version='1.1' id='svg738' inkscape:export-filename='sm_circled_face_happy.svg' inkscape:export-xdpi='96' inkscape:export-ydpi='96' sodipodi:docname='sm_circled_face_happy.svg' inkscape:version='1.2.1 (9c6d41e%2c 2022-07-14)' xmlns:inkscape='http://www.inkscape.org/namespaces/inkscape' xmlns:sodipodi='http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd' xmlns='http://www.w3.org/2000/svg' xmlns:svg='http://www.w3.org/2000/svg'%3e %3csodipodi:namedview id='namedview740' pagecolor='white' bordercolor='black' borderopacity='0.25' inkscape:showpageshadow='2' inkscape:pageopacity='0.0' inkscape:pagecheckerboard='0' inkscape:deskcolor='%23d1d1d1' inkscape:document-units='mm' showgrid='false' inkscape:zoom='1.1971536' inkscape:cx='143.25648' inkscape:cy='124.46189' inkscape:window-width='1535' inkscape:window-height='854' inkscape:window-x='179' inkscape:window-y='38' inkscape:window-maximized='0' inkscape:current-layer='layer1' /%3e %3cdefs id='defs735' /%3e %3cg inkscape:label='Layer 1' inkscape:groupmode='layer' id='layer1' transform='translate(-71.799516%2c-84.600851)'%3e %3ccircle style='fill:%23fff3f8%3bfill-opacity:1%3bstroke:none%3bstroke-width:3.96875%3bstroke-opacity:1%3bstroke-dasharray:none' id='path3312' cx='105.64484' cy='126.90308' inkscape:label='path3312' r='33.845322' inkscape:export-filename='sm_circled_face_happy.svg' inkscape:export-xdpi='96' inkscape:export-ydpi='96' /%3e %3cpath fill='%231f2937' d='m 124.50231%2c106.50433 c 0%2c0 6.5703%2c15.94019 2.46218%2c23.32273 -4.10891%2c7.39365 -8.78315%2c12.0782 -8.78315%2c12.0782 0%2c-3.03779 0.89483%2c-10.26631 0.89483%2c-15.19779 0%2c-4.92196 -3.28395%2c-5.91128 -5.91048%2c-3.28554 -2.62494%2c2.62573 -3.1196%2c7.06415 -3.1196%2c7.06415 0%2c0 -2.95444%2c-0.82417 -4.93148%2c-6.40514 -1.96752%2c-5.58098 -15.1073%2c-9.52474 -18.061747%2c3.28475 l -2.790091%2c2.29622 c -1.566547%2c-1.55463 -7.559603%2c-10.83323 -2.306546%2c-18.5556 5.260994%2c-7.72317 14.785727%2c-16.259383 27.759564%2c-12.973841 0%2c0 -0.71935%2c-5.426146 3.61426%2c-6.899002 3.43957%2c-1.174313 9.52553%2c-1.647534 13.30414%2c2.131872 5.65243%2c5.662754 1.52367%2c10.801471 -2.13188%2c13.138991 z' id='path213' style='stroke-width:0.793992' /%3e %3cpath fill='%23a41d5e' d='m 118.18134%2c141.90526 0.72968%2c11.90434 c 0%2c0 -21.01619%2c13.96237 -21.01619%2c11.98533 0%2c-4.95214 -0.492274%2c-11.98533 -0.492274%2c-11.98533 -3.976316%2c0.19536 -11.030145%2c-0.3295 -9.184906%2c-13.16043 -2.306549%2c-1.15286 -4.284384%2c-3.09974 -4.284384%2c-3.09974 0%2c0 3.119597%2c-8.05187 3.119597%2c-10.18374 2.954447%2c-12.80949 16.095027%2c-8.86652 18.061747%2c-3.28475 1.97704%2c5.58097 4.93148%2c6.40514 4.93148%2c6.40514 0%2c0 0.49466%2c-4.43842 3.1196%2c-7.06415 2.62732%2c-2.62574 5.91048%2c-1.63722 5.91048%2c3.28554 0%2c4.9307 -0.89483%2c12.16 -0.89483%2c15.19779 z' id='path215' style='stroke-width:0.793992' /%3e %3crect style='display:none%3bfill:%231f2937%3bfill-opacity:1%3bstroke:none%3bstroke-width:0.702536' id='rect978-6' width='4.5632801' height='1.5171214' x='11.843478' y='153.12173' ry='0' rx='0' transform='rotate(-29.741601)' /%3e %3cpath fill='%231f2937' d='m 99.473539%2c130.74894 c 0%2c-0.77176 -0.555002%2c-1.39981 -1.235454%2c-1.39981 -0.678864%2c0 -1.236245%2c0.62805 -1.236245%2c1.39981 0%2c0.77257 0.556589%2c1.4006 1.236245%2c1.4006 0.680452%2c-7.8e-4 1.235454%2c-0.62885 1.235454%2c-1.4006 z' id='path217' style='stroke-width:0.793992' /%3e %3cg id='g227' transform='matrix(0.79399255%2c0%2c0%2c0.79399255%2c-411.5556%2c13.612756)' style='display:none'%3e %3cline fill='none' stroke='%231f2937' stroke-width='2' x1='639.52032' y1='140.01994' x2='645.96429' y2='142.09769' id='line223' /%3e %3c/g%3e %3cg id='g227-0' transform='matrix(0.75421913%2c-0.24814848%2c0.24814848%2c0.75421913%2c-421.33304%2c178.99485)'%3e %3cline fill='none' stroke='%231f2937' stroke-width='2' x1='639.47241' y1='140.18233' x2='646.01221' y2='141.9353' id='line223-0' /%3e %3c/g%3e %3cline fill='none' stroke='%23e7e2e1' stroke-width='1.58799' stroke-linecap='round' stroke-linejoin='round' x1='114.36301' y1='134.67915' x2='114.15817' y2='137.74236' id='line229' /%3e %3cpath fill='none' stroke='%231f2937' stroke-width='2.38198' d='m 120.24493%2c99.191655 c 6.38846%2c-5.823936 16.64129%2c-5.50872 16.64129%2c-5.50872' id='path241' /%3e %3cpath fill='none' stroke='%231f2937' stroke-width='2.38198' d='m 117.49692%2c85.080819 c 1.50303%2c3.413375 1.77378%2c7.782716 0.95517%2c11.059522' id='path243' /%3e %3cpath fill='%231f2937' d='m 89.927499%2c130.54135 c 0%2c-0.77176 -0.555002%2c-1.39981 -1.235454%2c-1.39981 -0.678864%2c0 -1.236245%2c0.62805 -1.236245%2c1.39981 0%2c0.77257 0.556589%2c1.4006 1.236245%2c1.4006 0.680452%2c-7.8e-4 1.235454%2c-0.62885 1.235454%2c-1.4006 z' id='path217-7' style='stroke-width:0.793992' /%3e %3crect style='fill:%231f2937%3bfill-opacity:1%3bstroke:none%3bstroke-width:0.702536' id='rect978' width='4.5632801' height='1.5171214' x='89.601776' y='123.79742' ry='0.66174883' rx='0' transform='rotate(1.7063832)' /%3e %3cpath style='display:none%3bfill:%231f2937%3bfill-opacity:1%3bstroke:none%3bstroke-width:0.796634' d='m 104.02591%2c141.03438 c 0%2c0 -8.046899%2c2.43916 -11.24781%2c5.52175 -0.02093%2c0.0202 1.215206%2c-10.33527 11.24781%2c-5.52175 z' id='path3258' sodipodi:nodetypes='csc' /%3e %3cpath style='fill:%231f2937%3bfill-opacity:1%3bstroke:none%3bstroke-width:0.796634' d='m 92.646198%2c144.8927 c 0%2c0 8.209902%2c-1.81653 11.637212%2c-4.64526 0.0224%2c-0.0185 -2.00215%2c10.21204 -11.637212%2c4.64526 z' id='path3258-7' sodipodi:nodetypes='csc' /%3e %3c/g%3e%3c/svg%3e",triggerBackground:I="transparent",widgetPosition:L=v,widgetOffsetX:T=0,widgetOffsetY:O=0,widgetWidth:B="450px",widgetHeight:P="650px",fullscreen:S=!1,hide:D=!1,blockerVisible:j=!1,blockerOpacity:N=.2,overlayOpacity:W=0,disableScroll:C=!1,chatBubble:z=!0,chatBubbleDelay:$=3e3,chatBubbleTitle:H,chatBubbleSubtitle:M,chatBubbleResponse:R,mobile:U={fullscreen:!0},...K}){E=E+23+"px",x=x+23+"px",O=O+15+"px",T=T+15+"px",k+="px";let Y=b.any();const q={triggerRadius:k,triggerPosition:_,triggerOffsetX:x,triggerOffsetY:E,triggerIcon:A,triggerBackground:I,widgetPosition:L,widgetOffsetX:T,widgetOffsetY:O,widgetWidth:B,widgetHeight:P,blockerVisible:j,blockerOpacity:N,overlayOpacity:W},X=f[i];var J=document.createElement("div");J.id="sommify-container",J.className="sommify sommify__container",((e,i)=>{i=i||document.getElementById("sommify-container");const t=Object.keys(e).reduce(((i,t)=>({...i,[`--${t.replace(/([A-Z])/g,"-$1").toLowerCase()}`]:e[t]})),{});Object.keys(t).forEach((e=>{i.style.setProperty(e,t[e])}))})(q,J),w();const G=document.createElement("div");G.id="sommify-trigger",G.className="sommify__trigger",G.addEventListener("click",(()=>de()));const V=document.createElement("img");V.src=A,V.style.width="100%",V.style.height="100%";const F=_.includes("left")?"left":"right",Z=_.includes("top")?"top":"bottom",Q=document.createElement("div");Q.id="sommify-popup-chat",Q.className=`sommify__popup-box sommify__${F}-align`,Q.style[Z]=k+3*E+"px",Q.style[F]="23px",Q.style.maxWidth=`calc( 100vw - ${2*x}px )`,Q.style.zIndex=1;const ee=()=>{const e=parseInt(q.triggerRadius),i=parseInt(q.triggerOffsetY);Q.style[Z]=e+i*(Y?1.85:2.25)+"px"};ee(),Q.innerHTML=`\n    <div class="sommify__vignette"></div>\n\n    <div class="sommify__bubble sommify__shaded">\n      <div class="sommify__close sommify__display-on-hover">\n        <img src="data:image/svg+xml,%3c%3fxml version='1.0' encoding='UTF-8' standalone='no'%3f%3e%3c!-- Created with Inkscape (http://www.inkscape.org/) --%3e%3csvg width='72.281631mm' height='72.281639mm' viewBox='0 0 72.281631 72.281639' version='1.1' id='svg5' inkscape:export-filename='x.svg' inkscape:export-xdpi='96' inkscape:export-ydpi='96' xmlns:inkscape='http://www.inkscape.org/namespaces/inkscape' xmlns:sodipodi='http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd' xmlns='http://www.w3.org/2000/svg' xmlns:svg='http://www.w3.org/2000/svg'%3e %3csodipodi:namedview id='namedview7' pagecolor='white' bordercolor='black' borderopacity='0.25' inkscape:showpageshadow='2' inkscape:pageopacity='0.0' inkscape:pagecheckerboard='0' inkscape:deskcolor='%23d1d1d1' inkscape:document-units='mm' showgrid='false' /%3e %3cdefs id='defs2' /%3e %3cg inkscape:label='Layer 1' inkscape:groupmode='layer' id='layer1'%3e %3crect style='fill:black%3bstroke-width:0.68' id='rect288' width='96.279869' height='12.238898' x='2.9708989' y='-6.1194491' ry='5.3867416' transform='rotate(45)' inkscape:export-filename='x.svg' inkscape:export-xdpi='96' inkscape:export-ydpi='96' /%3e %3crect style='fill:black%3bstroke-width:0.68' id='rect288-4' width='96.279869' height='12.238898' x='-48.139935' y='-57.230282' ry='5.3867416' transform='rotate(135)' inkscape:export-filename='x.svg' inkscape:export-xdpi='96' inkscape:export-ydpi='96' /%3e %3c/g%3e%3c/svg%3e" width="8px"\n          style="filter: invert(100%) sepia(100%) saturate(2%) hue-rotate(197deg) brightness(104%) contrast(101%);" />\n      </div>\n      <span class="sommify__mobile-hide" style="font-weight: 400">${H||X.title}</span>\n      <span class="sommify__mobile-hide" style="color: #acb0bd; font-weight: 300">\n      ${M||X.subtitle}\n      </span>\n      <span class="sommify__mobile-show" style="font-weight: 400;">${X.mobile}</span>\n    </div>\n\n    <div class="sommify__response sommify__mobile-hide">\n      ${R||X.response}\n    </div>\n  `;const ie=function({id:e,className:i,properties:t}){const o=document.createElement("div");return Object.assign(o.style,t),o.id=e,o.className=i,o}({id:"sommify-mobile-vignette",className:"sommify__vignette-mobile"}),te=()=>Q.classList.contains("sommify__show")&&"none"!==Q.style.display,oe=()=>{Q.style.display="none",ie.style.display="none"};Q.querySelector(".sommify__close").addEventListener("click",(()=>{oe()})),Q.querySelector(".sommify__response").addEventListener("click",(()=>{de()}));const se=document.createElement("div");se.id="sommify-widget",se.className="sommify__widget";const ne=document.createElement("div");ne.id="sommify-overlay",ne.className="sommify__overlay",ne.addEventListener("click",(()=>le()));const ae=document.createElement("iframe");let ce;ae.src=`https://elements.sommify.ai?type=chat&apiKey=${e}&localization=${i}&currency=${t}`,ae.id="sommify-iframe",se.classList.add("sommify__widget--"+L),G.classList.add("sommify__trigger--"+_);const re=e=>e.preventDefault();function de(){((e,i=!1)=>{h(e,s,{throughChatBubble:i})})(g,te()),ce=window.scrollY,b.any()&&(Y=!0,se.classList.add("sommify__widget--fullscreen")),(se.classList.contains("sommify__widget--fullscreen")||C)&&document.documentElement.classList.add("sommify__locked"),J.classList.add("sommify__open"),J.addEventListener("pointermove",re),u=!0,oe()}function le(){h(g,n);const e=document.documentElement.classList.contains("sommify__locked");e&&document.documentElement.classList.remove("sommify__locked"),ae.contentWindow.postMessage({action:l},"*"),J.classList.remove("sommify__open"),J.removeEventListener("pointermove",re),e&&window.scrollTo(0,ce)}const me=()=>{w(),Y=b.any(),ee(),Y?J.classList.add("sommify__mobile"):J.classList.remove("sommify__mobile"),S||Y&&U.fullscreen?(se.classList.add("sommify__widget--fullscreen"),J.classList.contains("sommify__open")&&document.documentElement.classList.add("sommify__locked")):(se.classList.remove("sommify__widget--fullscreen"),C||Y||document.documentElement.classList.remove("sommify__locked"))};me(),G.appendChild(V),se.appendChild(ae);const pe=(async e=>{var i="sommify-css";if(!document.getElementById(i)){var t=document.getElementsByTagName("head")[0],o=document.createElement("link");o.id=i,o.rel="stylesheet",o.type="text/css",o.href="https://elements.sommify.ai/css/v1",o.media="all",t.appendChild(o)}o.onload=e})((()=>{J.appendChild(ne),J.appendChild(G),J.appendChild(se),J.appendChild(Q),J.appendChild(ie)}));window.addEventListener("resize",me),window.addEventListener("message",(e=>{e?.data?.action===r&&le()}));const ye=new Promise((e=>{window.addEventListener("message",(i=>{i.data.action===y&&(g=i.data.payload,e())}))})),fe=window.performance.navigation&&1===window.performance.navigation.type||window.performance.getEntriesByType("navigation").map((e=>e.type)).includes("reload");return{mount:async(e=(()=>{}))=>{document.body.appendChild(J),await Promise.all([pe,ye]),ae.contentWindow||await new Promise((e=>{ae.addEventListener("load",(()=>{e()}))})),h(g,o),console.log("event sent"),J.classList.add("sommify__loaded"),setTimeout((()=>{u||!z||fe||(Q.classList.add("sommify__show"),ie.style.opacity=1)}),$),e(),window.addEventListener("beforeunload",(()=>{h(g,c)}))},unmout:()=>{document.body.removeChild(J),h(g,a)},setApiKey:e=>{ae.contentWindow?.postMessage({action:m,payload:{apiKey:e}},"*")},onAddToCart:(e=(()=>{}))=>{window.addEventListener("message",(i=>{i?.data?.action===d&&e(i.data.payload)}))},onWinesUpdated:(e=(()=>{}))=>{window.addEventListener("message",(i=>{i?.data?.action===p&&e(i.data.payload)}))},updateParams:e=>{ae.contentWindow?ae.contentWindow.postMessage({action:m,payload:e},"*"):ae.addEventListener("load",(()=>{ae.contentWindow?.postMessage({action:m,payload:e},"*")}))},close:le,open:de}},Object.defineProperty(e,"__esModule",{value:!0})}));
