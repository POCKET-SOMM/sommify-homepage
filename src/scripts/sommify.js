!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).Sommify={})}(this,(function(e){"use strict";const t="https://elements.sommify.ai";const i=e=>{e.origin===t&&console.log(e.data)};var n="EXIT",o="ADD_TO_CART",s="FOCUS",a="BLUR",r="UPDATE_PARAMS",d="WINES_UPDATED";let c=!1;function l(e,t){const i=document.createElement("div");return Object.assign(i.style,t),i.id=e,i}const g=(e,{widgetWidth:t,widgetHeight:i,widgetPosition:n,widgetOffsetX:o,widgetOffsetY:s,fullscreen:a,hide:r})=>{let d={top:"unset",left:"unset",right:"unset",bottom:"unset"};if("center"===n)d={...d,top:"50%",left:"50%",transform:"translate(-50%, -50%)"};else{const e=n.includes("top")?"top":"bottom",t=n.includes("left")?"left":"right";d={...d,[t]:`calc(30px + ${o}px)`,[e]:`calc(30px + ${s}px)`}}return d=a?{top:0,left:0,right:"unset",bottom:"unset"}:d,{position:"fixed",width:a?"100vw":t,height:a?"100vh":i,maxWidth:a?"none":"calc( 100vw - 30*2px )",scale:e?1:.85,opacity:e?1:0,display:r?"none":"block",pointerEvents:e?"all":"none",transitionProperty:"opacity, scale",transitionDuration:"0.08s",transitionTimingFunction:"ease-in-out",transformOrigin:n.replace("-"," "),zIndex:999999,...d}},p=(e,{triggerRadius:t,triggerPosition:i,triggerOffsetX:n,triggerOffsetY:o,triggerBackground:s,hide:a})=>{const r=i.includes("top")?"top":"bottom",d={top:"unset",left:"unset",right:"unset",bottom:"unset",[i.includes("left")?"left":"right"]:`calc(36px + ${n}px)`,[r]:`calc(36px + ${o}px)`};return console.log("position:",d,"triggerPosition:",i),{borderRadius:"50%",display:"flex",background:s,justifyContent:"center",alignItems:"center",userSelect:"none",cursor:"pointer",width:`${t}px`,height:`${t}px`,position:"fixed",scale:e?1.2:1,opacity:e?0:1,visibility:a||e?"hidden":"visible",transition:"all 0.15s ease-in-out",cursor:"pointer",zIndex:999999,...d}};e.createEmbedded=function(e="interactive"){return{mount:(e,{width:n="420px",height:o="420px",...s})=>{var a=document.getElementById(e);if(a){const e=document.createElement("iframe"),r=function(e){const t=new URLSearchParams;for(const i in e)t.append(i,JSON.stringify(e[i]));return t.toString()}(s);e.src=t+"/interactive?"+r,e.height=o,e.width=n,e.style.border="none",a.appendChild(e),window.addEventListener("message",i)}else console.error(`Element with ID '${e}' not found.`)},unmount:e=>{var t=document.getElementById(e);t&&(t.innerHTML=""),window.removeEventListener("message",i)}}},e.createWidget=function({apiKey:e,triggerRadius:t=45,triggerPosition:i="bottom-right",triggerOffsetX:f=0,triggerOffsetY:h=0,triggerIcon:y="data:image/svg+xml,%3c%3fxml version='1.0' encoding='UTF-8' standalone='no'%3f%3e%3c!-- Created with Inkscape (http://www.inkscape.org/) --%3e%3csvg width='100' height='100' viewBox='0 0 26.458334 26.458334' version='1.1' id='svg5423' xml:space='preserve' xmlns='http://www.w3.org/2000/svg' xmlns:svg='http://www.w3.org/2000/svg'%3e%3cdefs id='defs5420' /%3e%3cg id='layer4'%3e%3ccircle style='display:inline%3bfill:none%3bfill-opacity:1%3bstroke:%23ebebeb%3bstroke-width:1.99954%3bstroke-dasharray:none%3bstroke-opacity:1' id='path256-7-3' cx='13.513306' cy='12.710953' r='6.138329' /%3e%3cpath style='display:inline%3bfill:%23b1b1b1%3bfill-opacity:1%3bstroke:none%3bstroke-width:1.42763%3bstroke-dasharray:none%3bstroke-opacity:1' d='m 17.776117%2c12.674485 c 0%2c0 -0.01618%2c4.282864 -4.28286%2c4.282864 -4.2666181%2c0 -4.2896308%2c-4.243931 -4.2896308%2c-4.243931 0%2c0 1.7907888%2c-1.481642 4.2896308%2c-0.03893 2.49884%2c1.442715 4.28286%2c0 4.28286%2c0 z' id='path1070-8-8-2' /%3e%3cpath style='display:inline%3bfill:white%3bfill-opacity:1%3bstroke:none%3bstroke-width:1.42978%3bstroke-dasharray:none%3bstroke-opacity:1' d='m 9.200331%2c12.710929 c 0%2c0 0.020635%2c4.282861 4.300155%2c4.282861 4.279462%2c0 4.29575%2c-4.282861 4.29575%2c-4.282861 0%2c0 -1.789379%2c-1.442706 -4.29575%2c0 -2.506363%2c1.442706 -4.300155%2c0 -4.300155%2c0 z' id='path1070-4-6' /%3e%3crect style='display:inline%3bfill:%23ebebeb%3bfill-opacity:1%3bstroke:none%3bstroke-width:12.2607%3bstroke-dasharray:none%3bstroke-opacity:1' id='rect2698-9' width='8.3613634' height='2.1883819' x='-14.040671' y='17.850616' transform='rotate(-45)' ry='1.094191' /%3e%3c/g%3e%3c/svg%3e",triggerBackground:b="#a51c5e",widgetPosition:m="bottom-right",widgetOffsetX:u=0,widgetOffsetY:w=0,hideMobile:v=!1,widgetWidth:x="450px",widgetHeight:k="650px",fullscreen:O=!1,limit:E=3,displayLimit:L=3,hide:P=!1,blockerVisible:W=!1,blockerOpacity:C=.2,mobile:j={fullscreen:!0},...I}){const T={apiKey:e,triggerRadius:t,triggerPosition:i,triggerOffsetX:f,triggerOffsetY:h,triggerBackground:b,widgetPosition:m,widgetOffsetX:u,widgetOffsetY:w,hideMobile:v,widgetWidth:x,widgetHeight:k,limit:E,displayLimit:L,hide:P,fullscreen:O,blockerVisible:W,blockerOpacity:C,...I};let S=window.innerWidth<768;var M=l({});const $=l("sommify-chat-bot-trigger",{...p(c,S?{...T,...j}:T),visibility:"hidden",opacity:0,scale:.7});$.addEventListener("mouseenter",(()=>{$.style.scale=1.1})),$.addEventListener("mouseleave",(()=>{$.style.scale=1}));const A=l("sommify-chat-bot-widget",g(c,S?{...T,...j}:T)),D=l("sommify-screen-blocker",{width:"100vw",height:"100vh",position:"fixed",background:W?"#000":"none",opacity:C,top:0,left:0,transitionProperty:"opacity, scale",transitionDuration:"0.25s",visibility:"hidden",zIndex:999998}),R=function(e,t){const i=document.createElement("img");return i.src=e,Object.assign(i.style,t),i}(y,{width:"100%",height:"100%"}),B=document.createElement("iframe");function U(){c=!c,Object.assign(A.style,{scale:c?1:.85,opacity:c?1:0,pointerEvents:c?"all":"none"}),Object.assign($.style,{scale:c?1.2:1,opacity:c?0:1,visibility:c?"hidden":"visible"}),Object.assign(D.style,{visibility:c?"visible":"hidden",opacity:c?C:0}),B.contentWindow.postMessage({action:c?s:a},"*")}return B.src=`https://elements.sommify.ai?type=chat&upwards=true&autofocus=true&apiKey=${e}&limit=${E}&displayLimit=${L}`,B.id="sommify-chat-bot-iframe",Object.assign(B.style,{width:"100%",height:"100%",border:"none"}),$.appendChild(R),$.addEventListener("click",U),A.appendChild(B),D.addEventListener("click",(e=>{U()})),window.addEventListener("resize",(()=>{let e=S!=window.innerWidth<768;S=window.innerWidth<768,e&&(Object.assign(A.style,g(c,S?{...T,...j}:T)),Object.assign($.style,p(c,S?{...T,...j}:T)))})),M.appendChild(D),M.appendChild($),M.appendChild(A),console.log("adding message listener..."),window.addEventListener("message",(e=>{e?.data?.action===n&&U()})),console.log("yo"),{mount:(e=(()=>{}))=>{console.log("yo"),document.body.appendChild(M),console.log("yo"),B.onload=()=>{Object.assign($.style,{visibility:"visible",opacity:1,scale:1}),console.log("yo"),e()}},unmout:()=>{document.body.removeChild(M)},setApiKey:e=>{B.contentWindow?.postMessage({action:r,payload:{apiKey:e}},"*")},onAddToCart:(e=(()=>{}))=>{window.addEventListener("message",(t=>{t?.data?.action===o&&e(t.data.payload)}))},onWinesUpdated:(e=(()=>{}))=>{window.addEventListener("message",(t=>{t?.data?.action===d&&e(t.data.payload)}))},updateParams:e=>{B.contentWindow?(console.log("POSTING MESSAGE"),B.contentWindow.postMessage({action:r,payload:e},"*")):(console.log("waiting for load"),B.addEventListener("load",(()=>{B.contentWindow?.postMessage({action:r,payload:e},"*")})))}}},Object.defineProperty(e,"__esModule",{value:!0})}));
