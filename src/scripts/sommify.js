!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).Sommify={})}(this,(function(e){"use strict";const t="https://elements.sommify.ai";const i=e=>{e.origin===t&&console.log(e.data)};var n="EXIT",o="ADD_TO_CART",s="FOCUS",a="BLUR",c="UPDATE_PARAMS",d="WINES_UPDATED";let r=!1;function l(e){r=e}function g(e,t){const i=document.createElement("div");return Object.assign(i.style,t),i.id=e,i}const p=(e,{widgetWidth:t,widgetHeight:i,widgetPosition:n,widgetOffsetX:o,widgetOffsetY:s,fullscreen:a,zIndex:c,hide:d})=>{let r={top:"unset",left:"unset",right:"unset",bottom:"unset"};if("center"===n)r={...r,top:"50%",left:"50%",transform:"translate(-50%, -50%)"};else{const e=n.includes("top")?"top":"bottom",t=n.includes("left")?"left":"right";r={...r,[t]:`calc(15px + ${o}px)`,[e]:`calc(15px + ${s}px)`}}return r=a?{top:0,left:0,right:"unset",bottom:"unset"}:r,{position:"fixed",width:a?"100vw":t,height:a?"100vh":i,maxWidth:a?"none":"calc( 100vw - 15*2px )",maxHeight:a?"none":"calc( 100vh - 15*2px )",scale:e?1:.85,opacity:e?1:0,display:d?"none":"block",pointerEvents:e?"all":"none",transitionProperty:"opacity, scale",transitionDuration:"0.08s",transitionTimingFunction:"ease-in-out",transformOrigin:n.replace("-"," "),zIndex:c,...r}},f=(e,{triggerRadius:t,triggerPosition:i,triggerOffsetX:n,triggerOffsetY:o,triggerBackground:s,zIndex:a,hide:c})=>{const d=i.includes("top")?"top":"bottom";return{borderRadius:"50%",display:"flex",background:s,justifyContent:"center",alignItems:"center",userSelect:"none",cursor:"pointer",width:`${t}px`,height:`${t}px`,position:"fixed",scale:e?1.2:1,opacity:e?0:1,visibility:c||e?"hidden":"visible",transition:"all 0.15s ease-in-out",cursor:"pointer",zIndex:a,...{top:"unset",left:"unset",right:"unset",bottom:"unset",[i.includes("left")?"left":"right"]:`calc(21px + ${n}px)`,[d]:`calc(21px + ${o}px)`}}};e.createEmbedded=function(e="interactive"){return{mount:(e,{width:n="420px",height:o="420px",...s})=>{var a=document.getElementById(e);if(a){const e=document.createElement("iframe"),c=function(e){const t=new URLSearchParams;for(const i in e)t.append(i,JSON.stringify(e[i]));return t.toString()}(s);e.src=t+"/interactive?"+c,e.height=o,e.width=n,e.style.border="none",a.appendChild(e),window.addEventListener("message",i)}else console.error(`Element with ID '${e}' not found.`)},unmount:e=>{var t=document.getElementById(e);t&&(t.innerHTML=""),window.removeEventListener("message",i)}}},e.createWidget=function({apiKey:e,triggerRadius:t=45,triggerPosition:i="bottom-right",triggerOffsetX:h=0,triggerOffsetY:y=0,triggerIcon:b="data:image/svg+xml,%3c%3fxml version='1.0' encoding='UTF-8' standalone='no'%3f%3e%3c!-- Created with Inkscape (http://www.inkscape.org/) --%3e%3csvg width='100' height='100' viewBox='0 0 26.458334 26.458334' version='1.1' id='svg5423' xml:space='preserve' xmlns='http://www.w3.org/2000/svg' xmlns:svg='http://www.w3.org/2000/svg'%3e%3cdefs id='defs5420' /%3e%3cg id='layer4'%3e%3ccircle style='display:inline%3bfill:none%3bfill-opacity:1%3bstroke:%23ebebeb%3bstroke-width:1.99954%3bstroke-dasharray:none%3bstroke-opacity:1' id='path256-7-3' cx='13.513306' cy='12.710953' r='6.138329' /%3e%3cpath style='display:inline%3bfill:%23b1b1b1%3bfill-opacity:1%3bstroke:none%3bstroke-width:1.42763%3bstroke-dasharray:none%3bstroke-opacity:1' d='m 17.776117%2c12.674485 c 0%2c0 -0.01618%2c4.282864 -4.28286%2c4.282864 -4.2666181%2c0 -4.2896308%2c-4.243931 -4.2896308%2c-4.243931 0%2c0 1.7907888%2c-1.481642 4.2896308%2c-0.03893 2.49884%2c1.442715 4.28286%2c0 4.28286%2c0 z' id='path1070-8-8-2' /%3e%3cpath style='display:inline%3bfill:white%3bfill-opacity:1%3bstroke:none%3bstroke-width:1.42978%3bstroke-dasharray:none%3bstroke-opacity:1' d='m 9.200331%2c12.710929 c 0%2c0 0.020635%2c4.282861 4.300155%2c4.282861 4.279462%2c0 4.29575%2c-4.282861 4.29575%2c-4.282861 0%2c0 -1.789379%2c-1.442706 -4.29575%2c0 -2.506363%2c1.442706 -4.300155%2c0 -4.300155%2c0 z' id='path1070-4-6' /%3e%3crect style='display:inline%3bfill:%23ebebeb%3bfill-opacity:1%3bstroke:none%3bstroke-width:12.2607%3bstroke-dasharray:none%3bstroke-opacity:1' id='rect2698-9' width='8.3613634' height='2.1883819' x='-14.040671' y='17.850616' transform='rotate(-45)' ry='1.094191' /%3e%3c/g%3e%3c/svg%3e",triggerBackground:u="#a51c5e",widgetPosition:m="bottom-right",widgetOffsetX:w=0,widgetOffsetY:v=0,hideMobile:x=!1,widgetWidth:k="450px",widgetHeight:O="650px",fullscreen:E=!1,zIndex:W=999999,hide:j=!1,blockerVisible:I=!1,blockerOpacity:L=.2,mobile:P={fullscreen:!0},...C}){const M={apiKey:e,triggerRadius:t,triggerPosition:i,triggerOffsetX:h,triggerOffsetY:y,triggerBackground:u,widgetPosition:m,widgetOffsetX:w,widgetOffsetY:v,hideMobile:x,widgetWidth:k,widgetHeight:O,hide:j,fullscreen:E,zIndex:W,blockerVisible:I,blockerOpacity:L,...C};let T=window.innerWidth<768;var z=g({});const A=g("sommify-chat-bot-trigger",{...f(r,T?{...M,...P}:M),visibility:"hidden",opacity:0,scale:.7});A.addEventListener("mouseenter",(()=>{A.style.scale=1.1})),A.addEventListener("mouseleave",(()=>{A.style.scale=1}));const D=g("sommify-chat-bot-widget",p(r,T?{...M,...P}:M)),R=g("sommify-screen-blocker",{width:"100vw",height:"100vh",position:"fixed",background:I?"#000":"none",opacity:L,top:0,left:0,transitionProperty:"opacity, scale",transitionDuration:"0.25s",visibility:"hidden",zIndex:W-1}),S=function(e,t){const i=document.createElement("img");return i.src=e,Object.assign(i.style,t),i}(b,{width:"100%",height:"100%"}),B=document.createElement("iframe");function U(){l(!1),Object.assign(D.style,{scale:.85,opacity:0,pointerEvents:"none"}),Object.assign(A.style,{scale:1,opacity:1,visibility:"visible"}),Object.assign(R.style,{visibility:"hidden",opacity:0}),B.contentWindow.postMessage({action:r?s:a},"*")}function X(){l(!0),Object.assign(D.style,{scale:1,opacity:1,pointerEvents:"all"}),Object.assign(A.style,{scale:1.2,opacity:0,visibility:"hidden"}),Object.assign(R.style,{visibility:"visible",opacity:L}),B.contentWindow.postMessage({action:r?s:a},"*")}function $(){r?U():X()}return B.src="https://elements.sommify.ai?type=chat&autofocus=true",B.id="sommify-chat-bot-iframe",Object.assign(B.style,{width:"100%",height:"100%",border:"none"}),A.appendChild(S),A.addEventListener("click",$),D.appendChild(B),R.addEventListener("click",(e=>{$()})),window.addEventListener("resize",(()=>{let e=T!=window.innerWidth<768;T=window.innerWidth<768,e&&(Object.assign(D.style,p(r,T?{...M,...P}:M)),Object.assign(A.style,f(r,T?{...M,...P}:M)))})),z.appendChild(R),z.appendChild(A),z.appendChild(D),window.addEventListener("message",(e=>{e?.data?.action===n&&$()})),{mount:(t=(()=>{}))=>{document.body.appendChild(z),B.onload=()=>{Object.assign(A.style,{visibility:"visible",opacity:1,scale:1}),B.contentWindow?.postMessage({action:c,payload:{apiKey:e,...C}},"*"),t()}},unmout:()=>{document.body.removeChild(z)},setApiKey:e=>{B.contentWindow?.postMessage({action:c,payload:{apiKey:e}},"*")},onAddToCart:(e=(()=>{}))=>{window.addEventListener("message",(t=>{t?.data?.action===o&&e(t.data.payload)}))},onWinesUpdated:(e=(()=>{}))=>{window.addEventListener("message",(t=>{t?.data?.action===d&&e(t.data.payload)}))},updateParams:e=>{B.contentWindow?B.contentWindow.postMessage({action:c,payload:e},"*"):B.addEventListener("load",(()=>{B.contentWindow?.postMessage({action:c,payload:e},"*")}))},close:U,open:X,toggle:$}},Object.defineProperty(e,"__esModule",{value:!0})}));
